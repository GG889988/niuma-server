<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>发布动态-牛马得闲</title>
  <style>
    body {
      margin: 0;
      padding: 20px;
      background: #fdf8f0;
      font-family: 宋体;
    }
    /* 顶部栏：返回按钮+“发布”标题 */
    .nav-top {
      display: flex;
      align-items: center;
      margin-bottom: 20px;
    }
    .back-btn {
      background: transparent;
      border: none;
      color: #8B7E6B;
      font-size: 18px;
      cursor: pointer;
    }
    .page-title {
      margin: 0 0 0 20px;
      font-size: 18px;
      color: #333;
    }
    /* 发布卡片：白色背景，居中 */
    .publish-card {
      background: white;
      border-radius: 8px;
      padding: 20px;
      max-width: 500px;
      margin: 0 auto;
    }
    /* 随机身份提示 */
    .identity-tip {
      color: #8B7E6B;
      font-size: 14px;
      margin-bottom: 15px;
    }
    /* 输入框：大一点，方便打字 */
    .content-input {
      width: 100%;
      min-height: 100px;
      border: 1px solid #eee;
      border-radius: 8px;
      padding: 10px;
      box-sizing: border-box;
      font-family: 宋体;
      font-size: 16px;
      margin-bottom: 10px;
    }
    /* 字数统计和图片按钮 */
    .tools {
      display: flex;
      justify-content: space-between;
      margin-bottom: 20px;
    }
    .word-count {
      color: #999;
      font-size: 14px;
    }
    .img-btn {
      background: transparent;
      border: 1px solid #8B7E6B;
      color: #8B7E6B;
      padding: 5px 10px;
      border-radius: 4px;
      cursor: pointer;
    }
    /* 发布按钮：默认灰色（没内容时），有内容变品牌色 */
    .publish-btn {
      width: 100%;
      padding: 12px;
      background: #ccc;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      cursor: not-allowed;
    }
    .publish-btn.active {
      background: #8B7E6B;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <!-- 顶部栏：返回按钮+标题 -->
  <div class="nav-top">
    <button class="back-btn" onclick="goBack()">← 返回</button>
    <h1 class="page-title">发布</h1>
  </div>

  <!-- 发布卡片 -->
  <div class="publish-card">
    <!-- 随机身份提示（每次打开换一个） -->
    <div class="identity-tip" id="identity">发布身份：今日·迷茫的河马</div>
    <!-- 内容输入框 -->
    <textarea class="content-input" placeholder="这里很安全，写下你想说的…" oninput="checkContent()"></textarea>
    <!-- 字数统计和图片按钮 -->
    <div class="tools">
      <div class="word-count" id="wordCount">0/300</div>
      <button class="img-btn">+ 添加图片（1-3张）</button>
    </div>
    <!-- 发布按钮 -->
    <button class="publish-btn" id="publishBtn" onclick="publish()">放下包袱，匿名发布</button>
  </div>

  <script>
    // 1. 随机身份列表（每次打开换一个）
    const identities = ['疲惫的骆驼', '迷茫的河马', '摸鱼的绵羊', '加班的斑马', '放空的奶牛'];
    // 页面加载时，随机选一个身份
    window.onload = () => {
      const randomId = identities[Math.floor(Math.random() * identities.length)];
      document.getElementById('identity').innerText = `发布身份：今日·${randomId}`;
    };

    // 2. 检查内容：有内容才激活发布按钮，还统计字数
    function checkContent() {
      const input = document.querySelector('.content-input');
      const content = input.value.trim();
      const wordCount = document.getElementById('wordCount');
      const publishBtn = document.getElementById('publishBtn');

      // 统计字数（不超过300）
      const count = content.length;
      wordCount.innerText = `${count}/300`;
      if (count > 300) {
        wordCount.style.color = 'red';
        input.value = content.slice(0, 300); // 超过300字截断
        wordCount.innerText = '300/300';
      } else {
        wordCount.style.color = '#999';
      }

      // 有内容就激活按钮（变品牌色）
      publishBtn.classList.toggle('active', count > 0 && count <= 300);
      publishBtn.disabled = !(count > 0 && count <= 300);
    }

    // 3. 发布功能：成功后有小动画，然后跳回动态页
    function publish() {
      const input = document.querySelector('.content-input');
      const content = input.value.trim();
      if (!content) return;

      // 发布成功提示（简单动画：按钮变绿一下）
      const publishBtn = document.getElementById('publishBtn');
      publishBtn.style.background = 'green';
      publishBtn.innerText = '发布成功！';

      // 1秒后跳回动态页
      setTimeout(() => {
        window.location.href = 'dynamic.html';
      }, 1000);
    }

    // 4. 返回按钮：点了回到动态页
    function goBack() {
      window.location.href = 'dynamic.html';
    }
  </script>
</body>
</html>
